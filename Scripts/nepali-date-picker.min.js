(function(e){function t(e){let t=e.split("-"),a=t[0]+"-";return a+=1==t[1].length?"0"+t[1]:t[1],a+="-",a+=1==t[2].length?"0"+t[2]:t[2],a}function a(){let t=b.length;if(t<1)e(".andp-datepicker-container").removeClass("open").hide();else{if(b=b.sort(function(e,t){return e=e.split("/").reverse().join(""),t=t.split("/").reverse().join(""),e>t?1:e<t?-1:0}),E)j.attr("value",b[0]).val(b[0]);else{for(e('input.andp-hidden-dates[data-cal_id="'+y+'"]').remove(),i=0;i<=t-1;i++)c(b[i]);var a="";a=1==j.data("show_all_dates")?j.is(":input")?b.join(", "):"<span>"+b.join("</span><span>")+"</span>":t>1?t+" dates selected":b[0],j.is(":input")?j.attr("value",a).val(a):j.html(a)}e(".andp-datepicker-container").removeClass("open").hide(),selected_date=e(this).data("date")}}function n(t){e(".andp-datepicker-container").removeClass("open").hide();var a=e('.andp-datepicker-container[data-cal_id="'+y+'"]');if(a.length>0)return w=a.find(".andp-year-select"),C=a.find(".andp-month-select"),N=a.find(".andp-days-numbers"),a.addClass("open").show(),void s();var n='<div class="andp-datepicker-container" data-cal_id="'+y+'" >';for(n+='<div class = "andp-header">',n+='<button type = "button"  class = "andp-prev andp-change-months"> &#10094; </button>',n+='<select class = "andp-month-select"> </select>',n+='<select class = "andp-year-select"> </select>',n+='<button type = "button" class = "andp-next andp-change-months"> &#10095; </button> ',n+="</div>",n+='<div class="andp-body">',n+='<div class = "andp-days-names"> <div> SUN </div> <div> MON </div> <div> TUE </div> <div> WED </div> <div> THU </div> <div> FRI </div> <div> SAT </div> </div>',n+='<div class = "andp-days-numbers"> </div>',E||(control_key="mac"==T?"CMD":"CTRL",n+='<div class="andp-info" style="display:none"><i class="mdi mdi-information text-primary"></i> Press <strong>'+control_key+"</strong> or <strong>Shift</strong> key for multiple selection </div>"),n+='<div class="andp-action-btns">',E||(n+='<button type="button" class="apply-date" data-cal_id="'+y+'">Apply</button>'),n+="</div>",n+="</div>",n+="</div>",_.append(n),a=e('.andp-datepicker-container[data-cal_id="'+y+'"]'),w=a.find(".andp-year-select"),C=a.find(".andp-month-select"),N=a.find(".andp-days-numbers"),append_html='<option value = "01" '+("01"==M?"selected":" ")+" > Baisakh </option>",append_html+='<option value = "02" '+("02"==M?"selected":"")+" > Jestha </option>",append_html+='<option value = "03" '+("03"==M?"selected":"")+" > Asar </option>",append_html+='<option value = "04" '+("04"==M?"selected":"")+" > Shrawan </option>",append_html+='<option value = "05" '+("05"==M?"selected":"")+" > Bhadra </option>",append_html+='<option value = "06" '+("06"==M?"selected":"")+" > Ashoj </option>",append_html+='<option value = "07" '+("07"==M?"selected":"")+" > Kartik </option>",append_html+='<option value = "08" '+("08"==M?"selected":"")+" > Mangsir </option>",append_html+='<option value = "09" '+("09"==M?"selected":"")+" > Poush </option>",append_html+='<option value = "10" '+("10"==M?"selected":"")+" > Magh </option> ",append_html+='<option value = "11" '+("11"==M?"selected":"")+" > Falgun </option>",append_html+='<option value = "12" '+("12"==M?"selected":"")+" > Chaitra </option>",C.append(append_html),i=k;i<=Y;i++)append_html='<option value="'+i+'"',i==D&&(append_html+=" selected"),append_html+=">"+i+"</option>",w.append(append_html);l(),e('.andp-datepicker-container[data-cal_id="'+y+'"]').addClass("open"),s()}function s(){var t=j.offset(),a=j.outerHeight(),n=e(window).width(),i=j.outerWidth(),s=e(".andp-datepicker-container").outerWidth();if(s+t.left+10>n){var l=n-(t.left+i);e('.andp-datepicker-container[data-cal_id="'+y+'"]').css({top:t.top+a,right:l,left:"inherit"})}else e('.andp-datepicker-container[data-cal_id="'+y+'"]').css({top:t.top+a,left:t.left,right:"inherit"})}function l(){month=C.val(),year=w.val(),N.html("");var e=new u;e.setNepaliDate(year,month,1);var t=e.getDay(),a=d(year,month);append_html="";var n=1,s=1,l=parseInt(t)-2,o=1;for(i=1;i<=42;i++){last_month=parseInt(month)-1,last_year=parseInt(year),last_month<1&&(last_month=12,last_year-=1,last_year<k&&(last_year=k,last_month=1)),next_month=parseInt(month)+1,next_year=parseInt(year);var h=d(last_year,last_month);if(1==n&&(append_html+='<div class="andp-column">'),i<t)append_html+='<div class="old-dates"> '+parseInt(h-l)+" </div>",l-=1;else if(s<=a){let e=s<10?"0"+s:s,t=year+"-"+month+"-"+e,a=b.indexOf(t);append_html+='<div class="day'+(a>=0?" selected":"")+'" data-date="'+t+'">'+s+"</div>",s++}else append_html+='<div  class="old-dates"> '+o+"</div>",o++;7==n&&(append_html+="</div>",n=0),n++}N.append(append_html)}function d(e,t){var a=new u;if(!(e<k||e>Y||t<1||t>12)){e=e-k,t=t-1;return a.nepaliMonths[e][t]}}function o(e,t){e=e.split("-"),t=t.split("-");var a=new u;return a.setNepaliDate(e[0],e[1],e[2]),a.getNepaliDateDifference(t[0],t[1],t[2])}function h(e,t){e=e.split("-"),t=t.split("-");var a=new u;a.setNepaliDate(e[0],e[1],e[2]);var n=[a.getEnglishYear(),a.getEnglishMonth(),a.getEnglishDate()];a.setNepaliDate(t[0],t[1],t[2]);var i=[a.getEnglishYear(),a.getEnglishMonth(),a.getEnglishDate()],s=new Date(n[0],n[1],n[2]),l=new Date(i[0],i[1],i[2]);return s>l&&1}function r(e){e=e.split("-"),year=parseInt(e[0]),month=parseInt(e[1]);var t=parseInt(d(year,month));return day=parseInt(e[2])+1,day>t&&(day=1,month+=1,month>12&&(month=1,year+=1)),year+"-"+month+"-"+day}function p(a,n=!1){a=t(a);var i=b.indexOf(a),s=e('.andp-datepicker-container[data-cal_id="'+y+'"]'),l=s.find('.day[data-date="'+a+'"]');n?l.addClass("soft-select"):i<0?(b.push(a),l.addClass("selected")):(b.splice(i,1),l.removeClass("selected"))}function c(e){L.append('<input class="andp-hidden-dates" type="hidden" data-cal_id="'+y+'" name="'+x+'[]" value="'+e+'">')}function u(){this.englishMonths=[31,28,31,30,31,30,31,31,30,31,30,31],this.englishLeapMonths=[31,29,31,30,31,30,31,31,30,31,30,31],this.nepaliMonths=[[30,32,31,32,31,30,30,30,29,30,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[30,32,31,32,31,30,30,30,29,30,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,29,30,30,29,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,29,30,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,29,30,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,30,29,31],[31,31,31,32,31,31,30,29,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,30],[31,32,31,32,31,30,30,30,29,30,29,31],[31,31,31,32,31,31,30,29,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[30,32,31,32,31,30,30,30,29,30,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,31,32,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[30,32,31,32,31,30,30,30,29,30,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[30,32,31,32,31,31,29,30,30,29,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,29,30,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,29,30,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,30,29,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,30],[31,32,31,32,31,30,30,30,29,30,29,31],[31,31,31,32,31,31,30,29,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,30],[31,32,31,32,31,30,30,30,29,30,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,31,32,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[30,32,31,32,31,30,30,30,29,30,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[30,32,31,32,31,31,29,30,29,30,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,29,30,30,29,29,31],[31,31,32,31,31,31,30,29,30,29,30,30],[31,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,29,30,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,31],[31,31,31,32,31,31,30,29,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,30],[31,32,31,32,31,30,30,30,29,30,29,31],[31,31,31,32,31,31,30,29,30,29,30,30],[31,31,32,31,31,31,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,29,30,30],[31,31,32,32,31,30,30,30,29,30,30,30],[30,32,31,32,31,30,30,30,29,30,30,30],[31,31,32,31,31,30,30,30,29,30,30,30],[31,31,32,31,31,30,30,30,29,30,30,30],[31,32,31,32,30,31,30,30,29,30,30,30],[30,32,31,32,31,30,30,30,29,30,30,30],[31,31,32,31,31,31,30,30,29,30,30,30],[30,31,32,32,30,31,30,30,29,30,30,30],[30,32,31,32,31,30,30,30,29,30,30,30],[30,32,31,32,31,30,30,30,29,30,30,30],[31,31,32,31,31,31,30,30,29,30,30,30],[30,31,32,32,31,30,30,30,29,30,30,30],[30,32,31,32,31,30,30,30,29,30,30,30],[31,31,32,31,31,30,30,30,29,30,30,30],[31,31,32,31,31,31,30,29,30,30,30,30],[30,31,32,32,31,30,30,29,30,29,30,30],[31,32,31,32,31,30,30,30,29,30,30,30],[31,31,32,31,31,31,29,30,29,30,29,31],[31,31,32,31,31,31,30,29,29,30,30,30]],this.setCurrentDate=function(){var e=new Date;this.setEnglishDate(e.getFullYear(),e.getMonth()+1,e.getDate())},this.setEnglishDate=function(e,t,a){if(!this.isEnglishRange(e,t,a))throw new Exception("Invalid date format.");this.englishYear=e,this.englishMonth=t,this.englishDate=a,this.nepaliYear=2e3,this.nepaliMonth=1,this.nepaliDate=1;for(var n=this.getEnglishDateDifference(1943,4,14),i=0;n>=this.nepaliYearDays(i);)this.nepaliYear++,n-=this.nepaliYearDays(i),i++;for(var s=0;n>=this.nepaliMonths[i][s];)n-=this.nepaliMonths[i][s],this.nepaliMonth++,s++;this.nepaliDate=this.nepaliDate+n,this.getDay()},this.toEnglishString=function(e){return void 0===e&&(e="-"),this.englishYear+e+this.englishMonth+e+this.englishDate},this.getEnglishDateDifference=function(e,t,a){var n=this.countTotalEnglishDays(this.englishYear,this.englishMonth,this.englishDate)-this.countTotalEnglishDays(e,t,a);return n<0?-n:n},this.countTotalEnglishDays=function(e,t,a){for(var n=365*e+a,i=0;i<t-1;i++)n+=this.englishMonths[i];return n+=this.countleap(e,t),n},this.countleap=function(e,t){return t<=2&&e--,Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)},this.isEnglishRange=function(e,t,a){return!(e<1944||e>2042)&&(!(t<1||t>12)&&!(a<1||a>31))},this.isLeapYear=function(e){return e%4==0&&(e%100!=0||e%400==0)},this.setNepaliDate=function(e,t,a){if(this.isNepaliRange(e,t,a)){this.nepaliYear=e,this.nepaliMonth=t,this.nepaliDate=a,this.englishYear=1944,this.englishMonth=1,this.englishDate=1;for(var n=this.getNepaliDateDifference(2e3,9,17);n>=(this.isLeapYear(this.englishYear)?366:365);)n-=this.isLeapYear(this.englishYear)?366:365,this.englishYear++;for(var i=this.isLeapYear(this.englishYear)?this.englishLeapMonths:this.englishMonths,s=0;n>=i[s];)this.englishMonth++,n-=i[s],s++;this.englishDate=this.englishDate+n,this.getDay()}else console.log("Invalid Date Format")},this.toNepaliString=function(e){return void 0===e&&(e="-"),this.nepaliYear+e+this.nepaliMonth+e+this.nepaliDate},this.getNepaliDateDifference=function(e,t,a){var n=this.countTotalNepaliDays(this.nepaliYear,this.nepaliMonth,this.nepaliDate)-this.countTotalNepaliDays(e,t,a);return n<0?-n:n},this.countTotalNepaliDays=function(e,t,a){var n=0;if(e<2e3)return 0;n+=a-1;for(var i=e-2e3,s=0;s<t-1;s++)n+=this.nepaliMonths[i][s];for(s=0;s<i;s++)n+=this.nepaliYearDays(s);return n},this.nepaliYearDays=function(e){for(var t=0,a=0;a<12;a++)t+=this.nepaliMonths[e][a];return t},this.isNepaliRange=function(e,t,a){return!(e<2e3||e>2098)&&(!(t<1||t>12)&&!(a<1||a>this.nepaliMonths[e-2e3][t-1]))},this.getDay=function(){var e=this.getEnglishDateDifference(1943,4,14);return this.weekDay=(3+e%7)%7+1,this.weekDay},this.getEnglishYear=function(){return this.englishYear},this.getEnglishMonth=function(){return this.englishMonth},this.getEnglishDate=function(){return this.englishDate},this.getNepaliYear=function(){return this.nepaliYear},this.getNepaliMonth=function(){return this.nepaliMonth},this.getNepaliDate=function(){return this.nepaliDate}}var _=e("body"),f=new u;f.setCurrentDate();let g=f.nepaliYear+"-"+f.nepaliMonth+"-"+f.nepaliDate;e("form").attr("autocomplete","off");var v,m=1,y="",D=f.getNepaliYear(),M=f.getNepaliMonth(),k=2e3,Y=2098,E=0,w="",C="",N="",b=[],I="",x="",T="win",j="",L="";e.fn.nepaliDatePicker=function(){navigator.platform.toUpperCase().indexOf("MAC")>=0&&(T="mac"),e(this).each(function(){let t=e(this);e(this).attr("data-cal_id","cal-"+m),m++,e(this).addClass("andp-date-picker");var a=e.trim(e(this).attr("value"));let n=e(this).data("single");if(E=1==n||1==n?1:0,a&&!E){L=e(this).parents("form"),y=e(this).data("cal_id"),x=e(this).attr("name");let n=a.split(",");if(n.forEach(function(e,t){c(e.trim())}),1!=e(this).data("show_all_dates"))n.length>1?output_msg=n.length+" dates selected":output_msg=n[0],e(this).attr("value",output_msg);else if(!t.is("input")){let e=a.split(","),n="<span>"+e.join("</span><span>")+"</span>";t.append(n)}}}),e(this).click(function(){if(v=this,b=[],j=e(this),data_single=e(this).data("single"),E=1==data_single||1==data_single?1:0,y=e(this).data("cal_id"),n(this),E)selected_date=t(e(this).val()),selected_date.length>0?(older_date_ar=selected_date.split("-"),C.val(older_date_ar[1]).change(),w.val(older_date_ar[0]).change(),p(selected_date)):p(g,!0);else{L=e(this).parents("form"),x=e(this).attr("name"),x?e(this).removeAttr("name","").attr("data-name",x):x=e(this).attr("data-name");var a=e('input.andp-hidden-dates[data-cal_id="'+y+'"]'),i=a.length;if(i>0)if(1==i)selected_date=t(a.eq(0).val()),older_date_ar=selected_date.split("-"),C.val(older_date_ar[1]).change(),w.val(older_date_ar[0]).change(),p(selected_date);else{older_date=e('input.andp-hidden-dates[data-cal_id="'+y+'"]');let n=older_date.length;older_date=t(older_date.eq(n-1).val()),older_date&&older_date.length>0&&(older_date_ar=older_date.split("-"),C.val(older_date_ar[1]).change(),w.val(older_date_ar[0]).change()),a.each(function(){let a=t(e(this).val());p(a)})}else p(g,!0)}}),_.on("change",".andp-month-select, .andp-year-select",function(){l()})},_.on("click",".andp-datepicker-container.open .andp-change-months",function(t){selected_month=parseInt(C.val()),selected_year=parseInt(w.val()),e(this).hasClass("andp-next")?(selected_month+=1,selected_month>12&&(selected_month=1,selected_year+=1,selected_year>Y&&(selected_year=Y,selected_month=12))):(selected_month-=1,selected_month<1&&(selected_month=12,selected_year-=1,selected_year<k&&(selected_year=k,selected_month=1))),selected_month<10&&(selected_month="0"+selected_month),selected_year<10&&(selected_year="0"+selected_year),C.val(selected_month).change(),w.val(selected_year).change()}),_.on("click",".andp-datepicker-container.open .andp-days-numbers .day",function(t){selected_day=e(this).text(),selected_date=e(this).data("date");var n=e('.andp-datepicker-container[data-cal_id="'+y+'"]');if(E)b=[],n.find(".andp-column .day").removeClass("selected"),p(selected_date),n.find(".andp-info").hide(),a();else if(t.shiftKey){var s=b.length;if(s>0){selected_date=e(this).data("date"),I=b[s-1];var l=h(selected_date,I)?I:selected_date,d=l,c=o(selected_date,I);for(b=[],n.find(".andp-column .day").removeClass("selected"),p(d),i=1;i<=c;i++)d=r(d),p(d)}}else t.ctrlKey||t.metaKey?p(selected_date):(b=[],n.find(".andp-column .day").removeClass("selected"),p(selected_date),n.find(".andp-info").show());e("document").trigger("andp_date_selected",[b,v])}),_.on("click",function(t){var a=e(".andp-datepicker-container, .andp-date-picker");a.is(t.target)||0!==a.has(t.target).length||e(".andp-datepicker-container").removeClass("open").hide()}),_.on("click",".andp-datepicker-container.open .apply-date",function(){a()})})(jQuery);